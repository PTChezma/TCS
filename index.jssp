!function(){metadata={systemName:"tcs.salesui.JSBroker",displayName:"SalesUI Broker",description:"SalesUI API"};const e="X-IBM-Client-Id",t="899659cad4626c71e1c79f323e23e11f",r="https://eapi-qa.tcsgroup.ch/tcs-qa/partner-catalog/insurance/v1";function a(e){var t=Date.now()-Date.parse(e),r=new Date(t);return Math.abs(r.getUTCFullYear()-1970)}ondescribe=async function(){postSchema({objects:{BuyableProducts:{displayName:"Buyable Products",description:"Buyable Products List",properties:{productID:{displayName:"productID",type:"number"},id:{displayName:"id",type:"number"},productExtCode:{displayName:"productExtCode",type:"number"},productName:{displayName:"productName",type:"string"}},methods:{getList:{displayName:"Get Buyable Products List",type:"list",parameters:{externalContactId:{displayName:"externalContactId",description:"Description Of externalContactId",type:"number"},userID:{displayName:"userID",description:"Description Of userID",type:"number"}},requiredParameters:["externalContactId","userID"],outputs:["productID","id","productExtCode","productName"]}}},Contact:{displayName:"Contact",description:"Contact",properties:{FirstName:{displayName:"FirstName",type:"string"},StartDate:{displayName:"StartDate",type:"string"},LastName:{displayName:"LastName",type:"string"},Adresse:{displayName:"Adresse",type:"string"},gender:{displayName:"gender",type:"string"},telephones:{displayName:"telephones",type:"string"},Age:{displayName:"Age",type:"string"},familyStatus:{displayName:"familyStatus",type:"string"},FullName:{displayName:"FullName",type:"string"}},methods:{getContact:{displayName:"getContact",type:"read",parameters:{externalContactId:{displayName:"externalContactId",description:"Description Of externalContactId",type:"number"}},requiredParameters:["externalContactId"],outputs:["FirstName","LastName","Adresse","gender","telephones","Age","familyStatus","FullName","StartDate"]}}},UserProductsList:{displayName:"User Products List",description:"User Products List",properties:{productID:{displayName:"productID",type:"string"},Name:{displayName:"Name",type:"string"},Satatus:{displayName:"Satatus",type:"string"},Reduction:{displayName:"Reduction",type:"string"},Price:{displayName:"Price",type:"string"},StartDate:{displayName:"StartDate",type:"string"},EndDate:{displayName:"EndDate",type:"string"},ExistCompagne:{displayName:"ExistCompagne",type:"boolean"},Action:{displayName:"Action",type:"string"},currencyVO:{displayName:"currencyVO",type:"string"},EntityType:{displayName:"EntityType",type:"string"},productExtCode:{displayName:"productExtCode",type:"string"}},methods:{getUserProductsList:{displayName:"Get User Products List",type:"list",parameters:{externalContactNumber:{displayName:"externalContactNumber",description:"Description Of externalContactNumber",type:"number"},userID:{displayName:"userID",description:"Description Of userID",type:"number"},activeAfter:{displayName:"activeAfter",description:"Description Of activeAfter",type:"string"},activeBefore:{displayName:"activeBefore",description:"Description Of activeBefore",type:"string"}},requiredParameters:["externalContactNumber"],outputs:["productID","Name","Satatus","Reduction","Price","StartDate","EndDate","ExistCompagne","Action","currencyVO","EntityType","productExtCode"]}}}}})},onexecute=async function({objectName:s,methodName:o,parameters:n,properties:i,configuration:p}){switch(s){case"BuyableProducts":await async function(e,t,r,a){switch(e){case"getList":await function(e,t){return new Promise((t,r)=>{var a=new XMLHttpRequest;if(a.onreadystatechange=function(){try{if(4!==a.readyState)return;if(200!==a.status)throw new Error("Failed with status "+a.status);var e=JSON.parse(a.responseText);postResult(e.products.map(e=>({productID:e.productID,id:e.id,productExtCode:e.productExtCode,productName:e.productName}))),t()}catch(e){r()}},"number"!=typeof e.externalContactId)throw new Error('properties["id"] is not of type number');if("number"!=typeof e.userID)throw new Error('properties["id"] is not of type number');var s="https://eapi-qa.tcsgroup.ch/tcs-qa/partner-catalog/insurance/v1/idit-product-version-ids?externalContactId="+encodeURIComponent(e.externalContactId)+"&userID="+encodeURIComponent(e.userID);a.open("GET",s),a.setRequestHeader("X-IBM-Client-Id","899659cad4626c71e1c79f323e23e11f"),a.send()})}(t);break;default:throw new Error("The method "+e+" is not supported.")}}(o,n);break;case"UserProductsList":await async function(a,s,o,n){switch(a){case"getUserProductsList":await async function(a,s){var o=[];(await function(a){var s=new XMLHttpRequest;return new Promise((function(o,n){if(s.onreadystatechange=function(){4==s.readyState&&(s.status>=300?n("Error, status code = "+s.status):o(JSON.parse(s.responseText)))},"number"!=typeof a.externalContactNumber)throw new Error('properties["externalContactNumber"] is not of type number');s.open("get",r+"/idit-proposals?externalContactNumber="+encodeURIComponent(a.externalContactNumber)),s.setRequestHeader(e,t),s.send()}))}(a))[0].proposalInListIBO.forEach((function(e){var t={productID:e.productId,Satatus:e.statusCodeVO.Proposal,Name:e.productVO.desc,Reduction:e.productId,Price:e.policyYearlyPremium.amount,StartDate:e.startDate,EndDate:e.endDate,ExistCompagne:!1,Action:"Modifier",EntityType:"PortfolioProposals",currencyVO:e.policyYearlyPremium.currencyVO.extCode,productExtCode:e.productVO.extCode};10==e.statusCodeVO.id&&o.push(t)})),(await function(a){var s=new XMLHttpRequest;return new Promise((function(o,n){if(s.onreadystatechange=function(){4==s.readyState&&(s.status>=300?n("Error, status code = "+s.status):o(JSON.parse(s.responseText)))},"number"!=typeof a.externalContactNumber)throw new Error('properties["externalContactNumber"] is not of type number');s.open("get",r+"/idit-policies?externalContactNumber="+encodeURIComponent(a.externalContactNumber)+"&activeAfter=2020-11-05T00:00:00&activeBefore=2021-12-25T00:00:00"),s.setRequestHeader(e,t),s.send()}))}(a))[0].policyInListIBO.forEach((function(e){var t={productID:e.productId,Satatus:e.statusCodeVO.Proposal,Name:e.productVO.desc,Reduction:e.productId,Price:e.policyYearlyPremium.amount,StartDate:e.startDate,EndDate:e.endDate,ExistCompagne:!1,Action:"Modifier",EntityType:"PortfolioPolicies",currencyVO:e.policyYearlyPremium.currencyVO.extCode,productExtCode:e.productVO.extCode};20==e.statusCodeVO.id&&o.push(t)}));var n=await function(a){var s=new XMLHttpRequest;return new Promise((function(o,n){if(s.onreadystatechange=function(){if(4==s.readyState)if(s.status>=300)n("Error, status code = "+s.status);else{var e=JSON.parse(s.responseText);o(e.products.map(e=>e))}},"number"!=typeof a.externalContactNumber)throw new Error('properties["externalContactNumber"] is not of type number');if("number"!=typeof a.userID)throw new Error('properties["userID"] is not of type number');var i=r+"/idit-product-version-ids?externalContactId="+encodeURIComponent(a.externalContactNumber)+"&userID="+encodeURIComponent(a.userID);s.open("get",i),s.setRequestHeader(e,t),s.send()}))}(a);return Object.values(n).forEach((function(e){var t={productID:e.productID,Name:e.productName,Action:"Ajouter",EntityType:"BuyableProducts",productExtCode:e.productExtCode};o.push(t)})),new Promise((e,t)=>{try{let t=o.reduce((e,t)=>(e[t.Name]=[...e[t.Name]||[],t],e),{});var r=[];Object.keys(t).forEach((function(e){t[e].forEach(e=>{r.push(e)})})),postResult(r),e()}catch(e){t(e)}})}(s);break;default:throw new Error("The method "+a+" is not supported.")}}(o,n);break;case"Contact":await async function(e,t,r,s){switch(e){case"getContact":await function(e,t){return new Promise((t,r)=>{var s=new XMLHttpRequest;if(s.onreadystatechange=function(){try{if(4!==s.readyState)return;if(200!==s.status)throw new Error("Failed with status "+s.status);var e=JSON.parse(s.responseText);postResult({FirstName:e.firstName,LastName:e.name,Adresse:e.addresses[0].houseNr+" "+e.addresses[0].streetName+" "+e.addresses[0].zipCode+" "+e.addresses[0].cityName+" "+e.addresses[0].country.desc,telephones:e.telephones,Age:a(e.dateOfBirth),familyStatus:e.familyStatus.desc,gender:e.gender.desc,FullName:e.gender.desc+" "+e.firstName+" "+e.name,StartDate:Date.parse(e.contactRelationships[0].effectiveDate).toString().slice(0,10)}),t()}catch(e){r()}},"number"!=typeof e.externalContactId)throw new Error('properties["id"] is not of type number');var o="https://idit-tcs-test2.sapiens.com/idit-web/api/contact/"+encodeURIComponent(e.externalContactId);s.open("GET",o),s.setRequestHeader("userName","administrator"),s.setRequestHeader("password","1111"),s.send()})}(t);break;default:throw new Error("The method "+e+" is not supported.")}}(o,n);break;default:throw new Error("The object "+s+" is not supported.")}}}();
//# sourceMappingURL=index.jssp.map
